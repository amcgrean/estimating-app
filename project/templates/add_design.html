{% extends "base.html" %}

{% block title %}Add New Design | Beisser.io{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="premium-card">
            <h2 class="mb-4 font-weight-bold" style="font-family: 'Outfit', sans-serif;">Add New Design</h2>
            <p class="text-muted mb-4 small">Submit project details for a new architectural design request.</p>

            <form action="{{ url_for('main.add_design') }}" method="POST">
                {{ form.hidden_tag() }}

                <div class="row">
                    <div class="col-md-8">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Plan Name</label>
                            <input type="text" name="plan_name" required class="input-modern"
                                placeholder="e.g. Oakwood Estate - Main Floor">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Branch</label>
                            <select name="branch_id" id="branch_id" class="input-modern">
                                {% for branch in branches %}
                                <option value="{{ branch.branch_id }}" {% if
                                    branch.branch_id==current_user.user_branch_id %}selected{% endif %}>
                                    {{ branch.branch_name }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Customer</label>
                            <select name="customer_id" class="input-modern">
                                {% for customer in customers %}
                                <option value="{{ customer.id }}">{{ customer.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Project Address</label>
                            <input type="text" name="project_address" required class="input-modern"
                                placeholder="123 Builder St, City, ST">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Contractor</label>
                            <input type="text" name="contractor" class="input-modern" placeholder="Contractor name...">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Preliminary Set
                                Date</label>
                            <input type="date" name="preliminary_set_date" class="input-modern">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Designer</label>
                            <select name="designer_id" class="input-modern">
                                {% for designer in designers %}
                                <option value="{{ designer.estimatorID }}">{{ designer.estimatorName }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Status</label>
                            <select name="status" class="input-modern">
                                <option value="Active">Active</option>
                                <option value="Bid Set">Bid Set</option>
                                <option value="Cancelled">Cancelled</option>
                                <option value="Completed">Completed</option>
                                <option value="On Hold">On Hold</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label class="font-weight-600 small text-uppercase tracking-wider">Type</label>
                            <select name="plan_description" class="input-modern">
                                <option value="New Design">New Design</option>
                                <option value="Redesign">Redesign</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="font-weight-600 small text-uppercase tracking-wider">Notes</label>
                    <textarea name="notes" class="input-modern" rows="4"
                        placeholder="Additional design specifications..."></textarea>
                </div>

                <div class="d-flex align-items-center justify-content-between mt-5">
                    <a href="{{ url_for('main.index') }}" class="btn text-muted font-weight-600">
                        <i class="fas fa-arrow-left mr-2"></i> Back to Dashboard
                    </a>
                    <button type="submit" class="btn-premium px-5 py-3">
                        <i class="fas fa-pencil-ruler mr-2"></i> Create Design
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('branch_id').onchange = function () {
        var branchId = this.value;
        var url = new URL(window.location.href);
        url.searchParams.set('branch_id', branchId);
        window.location.href = url.toString();
    };
</script>
{% endblock %}